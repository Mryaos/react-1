var Router=ReactRouter.Router,Route=ReactRouter.Route,hashHistory=ReactRouter.hashHistory,Link=ReactRouter.Link,List=React.createClass({displayName:"List",del:function(a){a.preventDefault();var b=this;confirm("确定删除?")&&(a.preventDefault(),ajax({url:"https://api.leancloud.cn/1.1/classes/CommentList/"+this.props.data.objectId,method:"delete",headers:{"X-LC-Id":"lhdmT7dDvREA6fpxF7IU6tCL-gzGzoHsz","X-LC-Key":"R7T6PUVPj06wGwJaWWE0lqzS","Content-Type":"application/json"},success:function(){alert("删除成功"),ajax({url:"https://api.leancloud.cn/1.1/classes/CommentList",method:"get",headers:{"X-LC-Id":"lhdmT7dDvREA6fpxF7IU6tCL-gzGzoHsz","X-LC-Key":"R7T6PUVPj06wGwJaWWE0lqzS","Content-Type":"application/json"},data:"order=-createdAt",success:function(a){var a=JSON.parse(unescape(a.replace(/\\u/g,"%u")));b.props.dataChange(a.results)}})}}))},datas:function(){return{name:this.props.data.name,content:this.props.data.content,time:this.props.data.time}},render:function(){return React.createElement("li",null,React.createElement("h3",{className:"user"},"留言人：",this.datas().name),React.createElement("p",{className:"comment"},"留言内容：",this.datas().content),React.createElement("a",{href:"javascript:;",onClick:this.del,className:"del"},"删除"),React.createElement("p",{className:"time"},"留言时间： ",this.datas().time))}}),CommentList=React.createClass({displayName:"CommentList",getInitialState:function(){return{data:[]}},dataOnChange:function(a){this.setState({data:a})},componentDidMount:function(){ajax({url:"https://api.leancloud.cn/1.1/classes/CommentList",method:"get",headers:{"X-LC-Id":"lhdmT7dDvREA6fpxF7IU6tCL-gzGzoHsz","X-LC-Key":"R7T6PUVPj06wGwJaWWE0lqzS","Content-Type":"application/json"},data:"order=-createdAt",success:function(a){var a=JSON.parse(unescape(a.replace(/\\u/g,"%u")));this.setState({data:a.results})}.bind(this)})},render:function(){var a=this;return React.createElement("div",{className:"comment-show",id:"comment-show"},React.createElement("ul",null,this.state.data.map(function(b){return React.createElement(List,{data:b,dataChange:a.dataOnChange})})))}}),CommentUpload=React.createClass({displayName:"CommentUpload",handleSubmit:function(a){a.preventDefault();var b=this.refs.username.getDOMNode().value,c=this.refs.content.getDOMNode().value;if(""==b||""==c)return void alert("请输入内容后再提交！");var d=new Date,e=d.getFullYear(),f=d.getMonth()+1,g=d.getDate();f=f>9?f:"0"+f;var h=d.getHours(),i=d.getMinutes(),j=d.getSeconds();i=i<10?"0"+i:i;var k=e+"-"+f+"-"+g+" "+h+":"+i+":"+j;ajax({url:"https://leancloud.cn:443/1.1/classes/CommentList",method:"post",headers:{"X-LC-Id":"lhdmT7dDvREA6fpxF7IU6tCL-gzGzoHsz","X-LC-Key":"R7T6PUVPj06wGwJaWWE0lqzS","Content-Type":"application/json"},data:{name:b,content:c,time:k},success:function(a){alert("提交成功"),this.refs.username.getDOMNode().value="",this.refs.content.getDOMNode().value=""}.bind(this)})},render:function(){return React.createElement("div",{className:"comment-upload",id:"comment-upload"},React.createElement("form",{action:"/",enctype:"application/json",method:"post",onSubmit:this.handleSubmit},React.createElement("label",{htmlFor:"username"},"name: ",React.createElement("input",{type:"text",className:"username",name:"username",ref:"username"})),React.createElement("label",{htmlFor:"content"},"words: ",React.createElement("textarea",{className:"content",name:"content",ref:"content"})),React.createElement("input",{type:"submit",value:"提交评论",className:"submit"})))}}),App=React.createClass({displayName:"App",render:function(){return React.createElement("div",{className:"comment-container"},React.createElement("header",{className:"header"},React.createElement("h2",{className:"title"},"Welcome to my lyb."),React.createElement("ul",{className:"tab-comment"},React.createElement("li",null,React.createElement(Link,{to:"/commentupload",activeClassName:"active"},"添加评论")),React.createElement("li",null,React.createElement(Link,{to:"/commentlist",activeClassName:"active"},"查看评论")))),this.props.children)}});ReactDOM.render(React.createElement(Router,{history:hashHistory},React.createElement(Route,{path:"/",component:App},React.createElement(Route,{path:"/commentupload",component:CommentUpload}),React.createElement(Route,{path:"/commentlist",component:CommentList}))),document.getElementById("container"));